### Run the Project (macOS + Windows)

Prereqs: Installed per `docs/howto/install.md`.

---

### Development

Start the dev environment (Vite + esbuild + Electron):
```bash
npm run dev
```

Renderer dev URL: http://localhost:5173/

Behavior:
- Vite dev server serves the Svelte renderer on port 5173.
- esbuild watches and rebuilds Electron main and preload to `dist/`.
- Electron launches and loads the dev server.

If port 5173 is busy, stop the other process or change `server.port` in `vite.config.mts`.
Aliases are defined in `vite.config.mts` and `tsconfig.json` (must match).

---

### Database (Drizzle + better-sqlite3)

The SQLite database and migrations live in the workspace package `packages/db`.

- DB file: `packages/db/data/gcomputer.db`
- Schema: `packages/db/src/db/schema.ts`
- Migrations: `packages/db/drizzle` (auto-generated by drizzle-kit)
- ORM init: `packages/db/src/db/client.ts`

Main process runs migrations on startup and exposes IPC handlers for CRUD on the test table.

During development:
- Changes to Electron main or preload require a fresh Electron restart to take effect.
  - Stop and restart the dev command: `Ctrl+C` then `npm run dev`.
  - After the window opens, you may need one hard reload (Cmd+R) of the window.
- Renderer hot-reloads automatically for Svelte/TS/SCSS changes.

Drizzle developer commands (run from repo root):
```bash
# Open Drizzle Studio UI
npm --workspace @gcomputer/db run drizzle:studio

# Re-generate migrations after editing schema.ts
npm --workspace @gcomputer/db run drizzle:generate
```

Manual DB test (optional):
```bash
npm --workspace @gcomputer/db run dev:test
```

Verify preload DB API in renderer DevTools:
```js
// In the console
window.gc // should include { settings, db }
await window.gc.db.test.list() // should return an array of rows
```

---

### Type checking
```bash
npm run typecheck
```

---

### Production build (local)

Build main/preload bundles and renderer assets:
```bash
npm run build
```

Artifacts:
- Electron main: `dist/main/index.cjs`
- Preload: `dist/preload/index.cjs`
- Renderer: `dist/renderer/`

To run Electron against the built assets (no dev server):
```bash
cross-env VITE_DEV_SERVER_URL= electron dist/main/index.cjs
```

Note: Packaging into installers is covered in `package.md`.


